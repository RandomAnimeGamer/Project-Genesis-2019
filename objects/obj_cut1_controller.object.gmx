<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-999997</depth>
  <persistent>0</persistent>
  <parentName>par_controller</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Create parts of the Cutscene.

    // Camera:
       instance_create(0, 0, obj_camera);       
      

    // Character specific:
       CharID   = 0;
       alarm[0] = 5;
    
    // Cutscene
        state = 0;
    
    // Reset Values:
       if(global.BonusStage = false){
          global.Rings        = 0;
          global.Time         = 0;
          global.GameTime     = 0;
          global.DoTime       = 0;       
          global.ObjectTime   = 0;
          global.CharControl  = 0;
          if(global.Ring100Check_Deactivate == false){
             global.Ring100Check = 1;
          }
          FrameRate           = 60;
          obj_audio_manager.DeadFade = false;
       }

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Pause screen variables.
    GamePaused = false;
    GamePBG    = noone;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Character specific variables.
    CharID = par_character.CharacterID - 1;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// (Un)Pause Game.

    
    if(global.DoTime == true &amp;&amp; instance_exists(par_fade) == false &amp;&amp; !instance_exists(obj_game_over)){
    
       // Check if we pressed Pause:
          if(keyboard_check_pressed(global.Key_ENTER)){
           
             // Pause the Game:   
                if(GamePaused == false &amp;&amp; GamePBG == noone &amp;&amp; instance_exists(obj_pause_menu) == false){
                   GamePaused = true;
                   GamePBG    = background_create_from_surface(application_surface, 0, 0, global.ScreenWidth, global.ScreenHeight, 0, 0);
                   instance_deactivate_all(1);
                   audio_pause_all();                   
                   if(global.BonusStage == false){
                      instance_create(0, 0, obj_pause_menu);
                      instance_activate_object(obj_pause_menu)
                   }
                   instance_activate_object(obj_global_manager)                  
                   exit;
                }
                
             // Unpause the Game:
                if(GamePaused == true &amp;&amp; GamePBG != noone){            
                   background_delete(GamePBG);
                   GamePaused = false;
                   GamePBG    = noone;
                   instance_activate_all();
                   audio_resume_all();  
                   if(instance_exists(obj_pause_menu)){
                      with(obj_pause_menu){
                           Finished = true;
                      }
                   }
                   exit;                 
                }
             
          }
    
    } 


</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Destroy instances outside the view.

    // We don't need any of this in a Bonus Stage:
    // So only run it when we're in an actual stage.
       if(global.BonusStage == false &amp;&amp; GamePaused == false){
    
    // Deactivate all objects:
       instance_deactivate_all(true);
       
    // Activate instances:
       instance_activate_object(par_controller);
        
    // Activate instances inside the view:
       for(i=0; i&lt;8; i+= 1){
           if(view_visible[i] == false){
              break;
           }
              instance_activate_region(view_xview[i] - 80, view_yview[i] - 80, view_wview[i] + 80, view_hview[i] + 80, true)
       }
    
    // Activate instances in a specific region while the character is moving fast.
       if(instance_exists(par_character)){
          for(i=0; i&lt;instance_number(par_character); i+=1){
              var _Ext, _Pl;
                  _Pl  = instance_find(par_character, i);
                  _Ext = max(abs(_Pl.XSpeed) * 3, abs(_Pl.YSpeed) * 3)
                         instance_activate_region((_Pl.x - view_wview[0] div 2) + min(-_Ext, 0),
                                                  (_Pl.y - view_hview[0] div 2) + min(-_Ext, 0), 
                                                  (view_wview[0]) + max(_Ext, 0),
                                                  (view_hview[0]) + max(_Ext, 0),
                                                  true);                
          }
       } 
    
    // Special case, when instances HAVE to be loaded:
       instance_activate_object(par_bridge);
       instance_activate_object(par_collision_pushable);
       instance_activate_object(obj_sth3_switch);
       instance_activate_object(par_collision_swing);
       instance_activate_object(par_collision_collapse);
       instance_activate_object(par_collision_collapse_tiles); 
       instance_activate_object(par_collision_moving);    
        
       }
       


    
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Global Timers.

    if(global.BonusStage == false &amp;&amp; GamePaused == false){
       if(global.DoTime &gt; 0){
          if(global.GameTime &lt; 599999){
             global.GameTime   += 1000/60;
          }else{
             global.GameTime = 599999
             if(instance_exists(par_character)){
                with(par_character){
                     Action = ActionDie;
                }
             }
          }
       }
    }
    
    if(GamePaused == false){
       global.ObjectTime += 1000/60;
    }


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Gain a life with 100 rings.

    if(global.Ring100Check &lt; 100){
    
       if(global.Rings &gt;= (global.Ring100Check * 100)){
       
          // Gain a life:
             global.Ring100Check++
             global.Lives++   
          
          // Play life jingle:
             PlaySound(snd_character_life, global.MaxSFXV, 1, 1)
       }
       
       // If we get hit and we no longer have any rings, set the check back to 1:
          if(global.Rings = 0 &amp;&amp; global.Ring100Check != 1){
             global.Ring100Check = 1;
          }
          
    }

</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// State 0

if(state == 0) {
    with(par_character) {
        KeyRight = true;
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="60">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Easter Egg.

   if(ds_map_find_value(async_load, "id") == KonamiLoaded){
      if(ds_map_find_value(async_load, "status") &gt;= 0 &amp;&amp; KonamiSprite == noone){
         PlaySound(egg_billiejean, global.BGMVolume, 1, 1);      
         KonamiSprite = KonamiLoaded;
         global.Lives = 30;
      }
   }
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Draw Pause frame.
    if(GamePBG != noone){
       draw_background(GamePBG, view_xview, view_yview);
    }
</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Draw the Hud.

    // Exit when the game is paused:
    if(GamePaused == true) exit;
    
    // Don't draw if in Bonus Stages:
    if(global.BonusStage == false){
       
    // SCORE/TIME/RINGS:
       draw_sprite(spr_main_hud, 0, view_xview[view_current]+floor(16), view_yview[view_current]+floor(9));
       if( ((global.GameTime div 8) mod 2 &amp;&amp; global.GameTime &gt; 540000) or global.GameTime &lt; 540000 or global.DoTime = 0){       
       draw_sprite(spr_main_hud, 1, view_xview[view_current]+floor(16), view_yview[view_current]+floor(25));
       }
       if(((global.Rings == 0) &amp;&amp; (global.GameTime div 8) mod 2 ) or global.Rings &gt; 0 or instance_exists(obj_scoring_results) || global.DoTime == 0){
          draw_sprite(spr_main_hud, 2, view_xview[view_current]+floor(16), view_yview[view_current]+floor(41));
       }

    // Text for SCORE/TIME/RINGS:
       draw_set_font(global.Font_HUD){
                     draw_set_color(c_white){
                                    draw_set_halign(fa_right);
                                    draw_text(view_xview[view_current]+111, view_yview[view_current]+9, global.Score);                                                          
                                    draw_set_halign(fa_left);
                                    if( ((global.GameTime div 8) mod 2 &amp;&amp; global.GameTime &gt; 540000) or global.GameTime &lt; 540000 or global.DoTime = 0){      
                                    draw_text(view_xview[view_current]+55, view_yview[view_current]+25, 
                                              string(floor(global.GameTime/60000))+" "+scr_string_number_format(floor(global.GameTime/1000) mod 60,2));
                                    }          
                                    draw_set_halign(fa_right);
                                    draw_text(view_xview[view_current]+87, view_yview[view_current]+41, global.Rings);
                                    draw_set_halign(-1);
                     }
       } 
           
    // Lives:
       draw_set_font(global.Font_Life){    
                     draw_set_halign(fa_right){
                                     draw_text(view_xview[0]+64, view_yview[0]+view_hview[0]-15, global.Lives);                     
                                     draw_sprite(spr_life_hud, CharID, view_xview[view_current]+floor(16), view_yview[view_current]+floor(200));  
                     }
                     draw_set_halign(-1)  
       }

      }else{ // Draw the Ring counter in Bonus Stages.
          draw_sprite(spr_main_hud, 2, view_xview[view_current]+floor(16), view_yview[view_current]+floor(9)); 
          draw_set_font(global.Font_HUD){
             draw_set_color(c_white){
                draw_set_halign(fa_right);          
                draw_text(view_xview[view_current]+88, view_yview[view_current]+9, global.Rings);    
                draw_set_halign(-1);                
             }
          }
      }

</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
